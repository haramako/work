options ( inesprg: 1, // プログラムにいくつのバンクを使うか。今は１つ。
          ineschr: 1, // グラフィックデータにいくつのバンクを使うか。今は１つ。
          inesmir: 0, // 水平ミラーリング
          inesmap: 0  // マッパー。０番にする。
          );

include( "nes.fc" );
include( "nes_util.fc" );

var vsync_flag:int;
var sprite_buf:[256]int options (address:0x0700);

function main(): void
{
  const PAL:[32]int = [0x0f,0x11,0x12,0x13, 0x0f,0x11,0x12,0x13, 0x0f,0x11,0x12,0x13, 0x0f,0x11,0x12,0x13,
                       0x0f,0x11,0x12,0x13, 0x0f,0x11,0x12,0x13, 0x0f,0x11,0x12,0x13, 0x0f,0x11,0x12,0x13];
  
  ppu_lock();
  ppu_init(0b10000000,0b00011110);
  ppu_scroll(0,0);
  
  PPU_ADDR = 0x3F;
  PPU_ADDR = 0x00;
  ppu_put( PAL, 32 );
  
  sprite_buf[0] = 30;
  sprite_buf[1] = 0x44;
  sprite_buf[2] = 0b00000000;
  sprite_buf[3] = 40;

  //ppu_fill( 32, 256 );
  ppu_unlock();
  wait_vsync();
  return;

  PPU_ADDR = 0x20;
  PPU_ADDR = 0x80;
  ppu_print( "HOGE.FUGA" );
  ppu_unlock();

  var x:int = 0;
  while( x < 12 ){
    PPU_ADDR = 0x21;
    PPU_ADDR = x;
    PPU_DATA = "HELLO, WORLD!"[x];
    x += 1;
    wait_vsync();
  }
  return;
}

main();
